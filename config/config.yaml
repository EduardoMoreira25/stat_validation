# Statistical Validation Configuration

# Comparison Thresholds
thresholds:
  row_count_tolerance_pct: 0.1      # 0.1% tolerance for row count differences
  ks_test_pvalue: 0.05              # 95% confidence level for KS-test
  psi_threshold: 0.1                # PSI < 0.1 = no change, 0.1-0.25 = moderate, >0.25 = significant
  null_rate_tolerance_pct: 2.0      # 2% tolerance for null rate differences
  null_rate_use_full_table: true    # NEW: Use full table for null rate tests (bypasses sampling)
  chi_square_pvalue: 0.05           # Chi-square test threshold
  t_test_pvalue: 0.05               # T-test threshold

# Sampling Configuration
sampling:
  enabled: true                     # change to false if dont want sample but want entire table
  strategy: 'hash'                  # Sampling strategy: 'hash' (recommended), 'random' (legacy)

  # Percentage-based sampling (set target_pct to enable - requires COUNT(*) on table)
  target_pct: null                  # Set to number (e.g., 5 = 5%) to use percentage-based sampling
  min_size: 1000                    # Minimum sample size (only used if target_pct is set)
  max_size: 1000000                 # Maximum sample size (only used if target_pct is set)

  # Legacy fixed-size sampling (used if target_pct is not set)
  max_sample_size: 50000            # Fixed sample size for large tables (legacy)
  min_sample_size: 30               # Minimum sample for statistical tests

  # Hash-based sampling options (only used when strategy='hash')
  hash_column: null                 # Column to use for hashing (null = auto-detect 'id', 'key', etc.)
  seed: 42                          # Seed for reproducibility (not used in hash strategy, deterministic by nature)

# SAP HANA-Specific Handling
sap_hana:
  # Treat these values as NULL when comparing SAP HANA data
  # This handles SAP's convention of using special values to represent "not set"
  null_equivalents:
    # Date fields: 00000000, 0000-00-00
    date_patterns: ['00000000', '0000-00-00', '00000000000000']
    # Time fields: 000000, 00:00:00
    time_patterns: ['000000', '00:00:00', '000000000000']
    # Numeric fields that represent "not set"
    numeric_patterns: []  # Add patterns like [0, -1] if needed
    # String fields (empty strings, spaces)
    string_patterns: ['', ' ']

  # Enable/disable transformation
  transform_null_equivalents: true

# Dremio-Specific Handling
dremio:
  # Treat these values as NULL when comparing Dremio data
  # This handles Dremio's storage of empty strings and other null-equivalent values
  null_equivalents:
    # Date fields (if stored as DATE type)
    date_patterns: ['00000000', '0000-00-00', '00000000000000']
    # Time fields (if stored as TIME type)
    time_patterns: ['000000', '00:00:00', '000000000000']
    # Numeric fields that represent "not set"
    numeric_patterns: []  # Add patterns like [0] ONLY if 0 should be treated as NULL
    # String fields - empty strings and date-like strings that represent NULL
    string_patterns: ['', ' ', '00000000', '0000-00-00', '00000000000000', '000000', '00:00:00', '000000000000']

  # Enable/disable transformation
  transform_null_equivalents: true

# Categorical Column Handling
categorical:
  max_cardinality_for_psi: 100      # Skip PSI if cardinality > this
  max_cardinality_for_chi_square: 50

# Performance
performance:
  parallel_column_tests: false      # Enable parallel processing (future)
  chunk_size: 10000                 # For chunked processing

# Reporting
reporting:
  output_format: ['json', 'html']   # Supported: json, html, csv
  save_detailed_stats: true
  include_visualizations: false     # Future feature

# Alerting
alerting:
  enabled: false
  on_failure_only: true
  channels: []                      # email, slack